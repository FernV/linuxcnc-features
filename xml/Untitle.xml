<LinuxCNC-Features>
  <feature src="ini/fv_drill-change.ini" after="" help="&lt;b&gt;Add drill change gcode&lt;/b&gt;&#10;Changes setting accordingly" o-name="Drill Change" image="tool-change.png" expanded="True" order="['PARAM_ENA', 'PARAM_H1', 'PARAM_N', 'PARAM_MOUNTED', 'PARAM_H2', 'PARAM_SPEED', 'PARAM_FEED', 'PARAM_R', 'PARAM_RM', 'PARAM_D', 'PARAM_Q', 'PARAM_ITEMS']" call="&#10;&#9;T#param_n M6 G43&#10;&#9;o&lt;#self_id-if&gt; if [#&lt;_global_tool_probe_set&gt;]&#10;&#9;&#9;o&lt;set-tool-length&gt; CALL&#10;&#9;o&lt;#self_id-if&gt; endif&#10;&#10;&#9;M3 S#param_speed&#10;&#10;&#9;#&lt;_global_drill_feed&gt; = #param_feed&#10;&#9;#&lt;_global_drill_retract&gt; = #param_r&#10;&#9;#&lt;_global_drill_retract_mode&gt; = #param_rm&#10;&#9;#&lt;_global_drill_dwell&gt; = #param_d&#10;&#9;#&lt;_global_drill_q&gt; = #param_q&#10;&#9;#&lt;_global_drill_feed&gt; = #param_feed&#10;&#9;#&lt;_global_drill_retract&gt; = #param_r&#10;&#9;#&lt;_global_drill_retract_mode&gt; = #param_rm&#10;&#9;#&lt;_global_drill_dwell&gt; = #param_d&#10;" selected="False" definitions="" before="" path="0" icon="tool-change.png" type="drillchng" id="drillchng-001" name="Drill Change 001">
    <param tool_tip="None" name="Enabled" value="1" call="#param_ena" path="0:0" type="bool" options="Sans option"/>
    <param tool_tip="None" name="&lt;b&gt;--- General ---&lt;/b&gt;" call="#param_h1" path="0:1" type="header" options="Sans option"/>
    <param tool_tip="From tool table" name="Drill number" value="51" call="#param_n" path="0:2" icon="num.png" type="int" options="Sans option" minimum_value="0"/>
    <param tool_tip="Tool already mounted and touched" name="Mounted already" value="0" call="#param_mounted" path="0:3" type="bool" options="Sans option"/>
    <param tool_tip="None" name="&lt;b&gt;--- Operation ---&lt;/b&gt;" call="#param_h2" path="0:4" type="header" options="Sans option"/>
    <param tool_tip="Set spindle speed" name="Spindle speed" value="1000" call="#param_speed" path="0:5" icon="tool-spindle.png" type="int" options="Sans option" minimum_value="0"/>
    <param tool_tip="Feed" name="Feed" value="1.000" call="#param_feed" path="0:6" minimum_value="0.0" type="float" options="Sans option" icon="feed.png"/>
    <param tool_tip="Retract height" name="Retract (R)" value="0.200" call="#param_r" path="0:7" type="float" options="Sans option" icon=""/>
    <param tool_tip="98 for position before cycles&#10;99 to retract to R position" name="Mode" value="98" call="#param_rm" path="0:8" type="combo" options="No retract=0:Full retract, G98=98:To 'R' height, G99=99" icon=""/>
    <param tool_tip="Number of seconds" name="Dwell (D)" value="3.000" call="#param_d" path="0:9" type="float" options="Sans option" icon=""/>
    <param tool_tip="Number of seconds" name="Delta (Q)" value="0.300" call="#param_q" path="0:10" type="float" options="Sans option" icon=""/>
    <param tool_tip="Items that use this drill" expanded="True" name="Items" selected="False" call="#param_items" path="0:11" type="items" options="Sans option" icon="items.png">
      <feature src="ini/mill/fv_circular-array.ini" expanded="True" help="&lt;b&gt;Create radial array of items&lt;/b&gt;" name="Radial Array 001" o-name="Radial Array" image="circular-array.png" after="&#10;&#9;&#9;&#9;; angle increment&#10;&#9;&#9;&#9;#&lt;#self_id-ang&gt;  = [#&lt;#self_id-ang&gt; + #param_fill / #param_num]&#10;&#9;&#9;O&lt;#self_id&gt; END REPEAT&#10;&#9;&#9;; restore coordinate system to it's origin&#10;&#9;&#9;G10 L2 P[#&lt;coord&gt;] X#&lt;#self_id-cx&gt; Y#&lt;#self_id-cy&gt; R[#&lt;#self_id-r0&gt;]&#10;&#9;&#9;O&lt;coordinate-sys-from-num&gt;&#9;CALL [#&lt;#self_id-restore-coord&gt;]&#10;&#9;&#9;G[#&lt;_coordinate-from-num&gt;]&#10;&#9;o&lt;#self_id-enabled&gt; endif&#10;&#9;(End Circular Array - #self_id)" id="array-001" call="" selected="False" path="0:11:0" definitions="" icon="circular-array.png" type="array" order="['PARAM_ENA', 'PARAM_H1', 'PARAM_NUM', 'PARAM_CX', 'PARAM_CY', 'PARAM_H2', 'PARAM_OPT', 'PARAM_D', 'PARAM_H3', 'PARAM_ANG', 'PARAM_FILL', 'PARAM_ROT', 'PARAM_H4', 'PARAM_COORD', 'PARAM_ITEMS']" before="&#10;(Circular Array - #self_id)&#10;&#9;o&lt;#self_id-enabled&gt; if [#param_ena]&#10;&#9;&#9;(Get cx,cy in machine coordinates)&#10;&#9;&#9;O&lt;get-offsets&gt; CALL&#10;&#9;&#9;#&lt;#self_id-cx&gt; = [#&lt;_get_offsets_x&gt; + #param_cx]&#10;&#9;&#9;#&lt;#self_id-cy&gt; = [#&lt;_get_offsets_y&gt; + #param_cy]&#10;&#9;&#9;#&lt;#self_id-r0&gt; = #&lt;_get_offsets_r&gt;&#10;&#9;&#9;#&lt;#self_id-r&gt; = #&lt;_get_offsets_r&gt;&#10;&#9;&#9;#&lt;#self_id-restore-coord&gt; = #5220&#10;&#10;&#9;&#9;(Circular Array)&#10;&#9;&#9;o&lt;#self_id-option&gt; if [#param_opt EQ 1] ; option distance between holes&#10;&#9;&#9;&#9;o&lt;#self_id-optiona&gt; if[#param_fill EQ 360]&#10;&#9;&#9;&#9;&#9;#&lt;#self_id-radius&gt; = [#param_d / 2 / SIN[180 / #param_num] * #&lt;_units_r&gt;]&#10;&#9;&#9;&#9;o&lt;#self_id-optiona&gt; else&#10;&#9;&#9;&#9;&#9;#&lt;#self_id-radius&gt; = [#param_d / SIN[#param_fill / #param_num] * #&lt;_units_r&gt;]&#10;&#9;&#9;&#9;o&lt;#self_id-optiona&gt; endif&#10;&#9;&#9;o&lt;#self_id-option&gt; else&#10;&#9;&#9;&#9;#&lt;#self_id-radius&gt; = [#param_d / 2 * #&lt;_units_r&gt;]&#10;&#9;&#9;o&lt;#self_id-option&gt; endif&#10;&#10;&#9;&#9;#&lt;#self_id-ang&gt; = [#param_ang + #&lt;_get_offsets_r&gt;]&#10;&#9;&#9;G[#param_coord]&#10;&#9;&#9;; full id of feature is used to make able array of array's&#10;&#9;&#9;O&lt;#self_id&gt; REPEAT [#param_num]&#10;&#9;&#9;&#9;G92.1 (disable G92 offsets - they ruin the array after rotating coordinates)&#10;&#10;&#9;&#9;&#9;(move and rotate coordinates)&#10;&#9;&#9;&#9;(Get rotated coordinates)&#10;&#9;&#9;&#9;O&lt;rotate-xy&gt; CALL [#&lt;#self_id-cx&gt; + [#&lt;#self_id-radius&gt;]] [#&lt;#self_id-cy&gt;] [#&lt;#self_id-cx&gt;] [#&lt;#self_id-cy&gt;] [#&lt;#self_id-ang&gt;]&#10;&#9;&#9;&#9;#&lt;#self_id-x&gt; = #&lt;_rotate_result_x&gt;&#10;&#9;&#9;&#9;#&lt;#self_id-y&gt; = #&lt;_rotate_result_y&gt;&#10;&#10;&#9;&#9;&#9;O&lt;coordinate-sys-to-num&gt; CALL [#param_coord]&#10;&#9;&#9;&#9;#&lt;coord&gt; = #&lt;_coordinate-to-num&gt;&#10;&#9;&#9;&#9;O&lt;#self_id-if&gt; IF [#param_rot] (Enable rotations)&#10;&#9;&#9;&#9;&#9;G10 L2 P[#&lt;coord&gt;] X#&lt;#self_id-x&gt; Y#&lt;#self_id-y&gt; R#&lt;#self_id-ang&gt;&#10;&#9;&#9;&#9;O&lt;#self_id-if&gt; ELSE&#10;&#9;&#9;&#9;&#9;G10 L2 P[#&lt;coord&gt;] X#&lt;#self_id-x&gt; Y#&lt;#self_id-y&gt; R#&lt;#self_id-r&gt;&#10;&#9;&#9;&#9;O&lt;#self_id-if&gt; ENDIF&#10;&#9;&#9;&#9;; array body&#10;">
        <param tool_tip="Disabling will disable ALL items" name="Enabled" value="1" call="#param_ena" path="0:11:0:0" type="bool" options="Sans option"/>
        <param tool_tip="None" name="&lt;b&gt;--- General ---&lt;/b&gt;" call="#param_h1" path="0:11:0:1" type="header" options="Sans option"/>
        <param tool_tip="Number of copies" name="Copies" value="3" call="#param_num" path="0:11:0:2" minimum_value="1" type="int" options="Sans option" icon="num.png"/>
        <param tool_tip="Array center" name="cX" value="0.000" call="#param_cx" path="0:11:0:3" type="float" options="Sans option" icon="center.png"/>
        <param tool_tip="Array center" name="cY" value="0.000" call="#param_cy" path="0:11:0:4" type="float" options="Sans option" icon="center.png"/>
        <param tool_tip="None" name="&lt;b&gt;--- Dimensions ---&lt;/b&gt;" call="#param_h2" path="0:11:0:5" type="header" options="Sans option"/>
        <param tool_tip="Select measuring option" name="Select option" value="0" call="#param_opt" path="0:11:0:6" type="combo" options="Diameter of array=0:Distance between sub-groups=1" icon="diameter.png"/>
        <param tool_tip="Diameter of array or&#10;distance between group of items" name="Diameter/Distance" value="2.000" call="#param_d" path="0:11:0:7" type="float" options="Sans option" icon="diameter.png"/>
        <param tool_tip="None" name="&lt;b&gt;--- Rotation ---&lt;/b&gt;" call="#param_h3" path="0:11:0:8" type="header" options="Sans option"/>
        <param digits="2" tool_tip="Angle of the first item" name="Start" value="0.00" call="#param_ang" path="0:11:0:9" type="float" options="Sans option" icon="angle.png"/>
        <param digits="2" tool_tip="Angle covered by items" name="Fill angle" value="180.00" call="#param_fill" path="0:11:0:10" type="float" options="Sans option" icon="angle.png"/>
        <param tool_tip="Rotate each item" name="Rotate items" value="1" call="#param_rot" path="0:11:0:11" type="bool" options="Sans option"/>
        <param tool_tip="None" name="&lt;b&gt;--- Coordinates ---&lt;/b&gt;" call="#param_h4" path="0:11:0:12" type="header" options="Sans option"/>
        <param tool_tip="Use this coordinate system&#10;Returns to prior coordinate system afterward" name="Coordinate system" value="57" call="#param_coord" path="0:11:0:13" type="combo" options="G55=55:G56=56:G57=57:G58=58:G59=59:G59.1=59.1:G59.2=59.2:G59.3=59.3"/>
        <param tool_tip="Items to copy" expanded="True" name="Items" selected="False" call="#param_items" path="0:11:0:14" type="items" options="Sans option" icon="items.png">
          <feature src="ini/mill/fv_bolt-circle.ini" expanded="False" help="&lt;b&gt;Create a regular circle&lt;/b&gt;" o-name="Drill Circle" image="simp.png" after="" name="Drill Circle 018" call="&#10; &#9;(Drill a regular circle of #param_num holes)&#10;&#9;o&lt;#self_id&gt; if [#param_ena]&#10;&#9;&#9;#&lt;d&gt; = [#param_dim * #&lt;_units_r&gt;]&#10;&#9;&#9;o&lt;#self_id-10&gt; if [#param_opt] ; option diameter&#10;&#9;&#9;&#9;#&lt;radius&gt; = [#&lt;d&gt; / 2]&#10;&#9;&#9;o&lt;#self_id-10&gt; else ; option distance between holes&#10;&#9;&#9;&#9;o&lt;#self_id-10a&gt; if[#&lt;extend&gt; EQ 360]&#10;&#9;&#9;&#9;&#9;#&lt;radius&gt; = [#&lt;d&gt; / 2 / SIN[180 / #param_num]]&#10;&#9;&#9;&#9;o&lt;#self_id-10a&gt; else&#10;&#9;&#9;&#9;&#9;#&lt;radius&gt; = [#&lt;d&gt; / SIN[#param_ext / #param_num]]&#10;&#9;&#9;&#9;o&lt;#self_id-10a&gt; endif&#10;&#9;&#9;o&lt;#self_id-10&gt; endif&#10;&#10;&#9;&#9;o&lt;#self_id-20&gt; if [[#param_ext MOD 360] NE 0]&#10;&#9;&#9;&#9;#&lt;extend&gt; = [#param_ext * #param_num / [#param_num - 1]]&#10;&#9;&#9;o&lt;#self_id-20&gt; else&#10;&#9;&#9;&#9;#&lt;extend&gt; = #param_ext&#10;&#9;&#9;o&lt;#self_id-20&gt; endif&#10;&#10;&#9;&#9;#&lt;i&gt; = 0&#10;&#9;&#9;o&lt;#self_id-loop&gt; while [#&lt;i&gt; LT #param_num]&#10;&#9; &#9;&#9;o&lt;rotate-xy&gt; CALL [#&lt;radius&gt;] [0] [0] [0] [#param_a + [#&lt;extend&gt; / #param_num] * #&lt;i&gt;]&#10;&#9;&#9;&#9;o&lt;fv_drill-one&gt; CALL [#param_cx + #&lt;_rotate_result_x&gt;] [#param_cy + #&lt;_rotate_result_y&gt;] [#param_depth] [#param_start]&#10;&#9;&#9;&#9;#&lt;i&gt; = [#&lt;i&gt; + 1]&#10;&#9;&#9;o&lt;#self_id-loop&gt; endwhile&#10;&#9;o&lt;#self_id&gt; endif&#10;" selected="False" path="0:11:0:14:0" id="drill-cir-018" definitions="" icon="tool.png" type="drill-cir" order="['PARAM_ENA', 'PARAM_H1', 'PARAM_NUM', 'PARAM_CX', 'PARAM_CY', 'PARAM_H2', 'PARAM_OPT', 'PARAM_DIM', 'PARAM_H4', 'PARAM_A', 'PARAM_EXT', 'PARAM_H3', 'PARAM_START', 'PARAM_DEPTH']" before="">
            <param tool_tip="None" name="Enabled" value="1" call="#param_ena" path="0:11:0:14:0:0" type="bool" options="Sans option"/>
            <param tool_tip="None" name="&lt;b&gt;--- General ---&lt;/b&gt;" call="#param_h1" path="0:11:0:14:0:1" type="header" options="Sans option"/>
            <param tool_tip="Number of holes" name="Number of holes" value="5" call="#param_num" path="0:11:0:14:0:2" minimum_value="2" type="int" options="Sans option" icon="num.png"/>
            <param tool_tip="Center of circle" name="cX" value="6.000" call="#param_cx" path="0:11:0:14:0:3" type="float" options="Sans option" icon="center.png"/>
            <param tool_tip="Center of circle" name="cY" value="0.000" call="#param_cy" path="0:11:0:14:0:4" type="float" options="Sans option" icon="center.png"/>
            <param tool_tip="None" name="&lt;b&gt;--- Dimension ---&lt;/b&gt;" call="#param_h2" path="0:11:0:14:0:5" type="header" options="Sans option"/>
            <param tool_tip="Select measuring option" name="Select option" value="1" call="#param_opt" path="0:11:0:14:0:6" type="combo" options="Diameter=1:Distance between holes=0"/>
            <param tool_tip="Diameter or distance" name="Dimension" value="2.000" call="#param_dim" path="0:11:0:14:0:7" minimum_value="0.0" type="float" options="Sans option" icon="diameter.png"/>
            <param tool_tip="None" name="&lt;b&gt;--- Coverage ---&lt;/b&gt;" call="#param_h4" path="0:11:0:14:0:8" type="header" options="Sans option"/>
            <param digits="2" tool_tip="Angle of the first hole" name="Start" value="0.00" call="#param_a" path="0:11:0:14:0:9" type="float" options="Sans option" icon="angle.png"/>
            <param digits="2" tool_tip="Angle covered by holes" name="Extend" value="360.00" call="#param_ext" path="0:11:0:14:0:10" type="float" options="Sans option" icon="angle.png"/>
            <param tool_tip="None" name="&lt;b&gt;--- Drilling params ---&lt;/b&gt;" call="#param_h3" path="0:11:0:14:0:11" type="header" options="Sans option"/>
            <param tool_tip="Start drilling at height" name="Start drilling" value="0.000" call="#param_start" path="0:11:0:14:0:12" minimum_value="0.0" type="float" options="Sans option" icon="surface.png"/>
            <param tool_tip="Depth of drilling" name="Drill depth" value="-0.300" call="#param_depth" path="0:11:0:14:0:13" type="float" options="Sans option" icon="dz.png"/>
          </feature>
        </param>
      </feature>
    </param>
  </feature>
</LinuxCNC-Features>
